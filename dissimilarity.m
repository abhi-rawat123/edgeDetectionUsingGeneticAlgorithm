%dissimilarity function

function [dis_mat] = dissimilarity(image)

dis_mat=image;
mi = size(image);
m=mi(1);

edges = [[0,1,0,0,1,0,0,1,0];[0,0,0,1,1,1,0,0,0];[0,0,1,0,1,0,1,0,0];[1,0,0,0,1,0,0,0,1];
    [1,0,0,0,1,0,0,1,0];[1,0,0,0,1,1,0,0,0];[0,1,0,0,1,0,0,0,1];[0,1,0,0,1,0,1,0,0];
    [0,0,1,0,1,0,0,1,0];[0,0,1,1,1,0,0,0,0];[0,0,0,0,1,1,1,0,0];[0,0,0,1,1,0,0,0,1]];
R1 =[[1,4,7,0];[0,7,8,9];[4,1,2,0];[0,4,7,8];[0,0,4,7];[4,7,8,9];[1,4,7,8];[0,0,1,4];
    [1,2,4,7];[7,8,9,6];[1,2,3,4];[1,2,3,6]];

for i=2:m-1
    for j=2:m-1
        val=0;
        for k=1:12
            arr=R1(k,:);
            sum_R1=0;
            sum_R2=0;
            c1=0;
            c2=0;
            for s=1:9
                a=floor((s-1)/3);
                b=mod((s-1),3);
                a=a+i-1;
                b=b+j-1;
                
                if (a>m || b>m)
                    continue;
                end
                flag=0;
                for g=1:4
                    if arr(g)==s
                        flag=1;
                        break;
                    end
                end
                if flag==1
                    sum_R2= sum_R2+ image(a,b);
                    c1=c1+1;
                else
                    sum_R1= sum_R1+ image(a,b);
                    c2=c2+1;
                    
                end
            end
            
            temp=(double(sum_R2)/c1-double(sum_R1)/c2);
            
            if(temp<0)
                temp=temp*-1;
            end
            if val < temp
                val = temp;
            end
        end
        
        dis_mat(i,j)=(val);
    end
    
end

end
































%
% edges(2) = [0,0,0,1,1,1,0,0,0];
% R1(2)=[7,8,9];
%
% edges(3) = [[0,0,1];
%     [0,1,0];
%     [1,0,0]];
% R1(3)=[4,1,2];
%
% edges(4) = [1,0,0,0,1,0,0,0,1];
% R1(4)=[4,7,8];
% edges(5) = [1,0,0,0,1,0,0,1,0];
% R1(5)=[4,7];
% edges(6) = [1,0,0,0,1,1,0,0,0];
% R1(6)=[4,7,8,9];
% edges(7) = [0,1,0,0,1,0,0,0,1];
% R1(7)=[1,4,7,8];
% edges(8) = [0,1,0,0,1,0,1,0,0];
% R1(8)=[1,4];
% edges(9) = [0,0,1,0,1,0,0,1,0];
% R1(9)=[1,2,4,7];
% edges(10) = [0,0,1,1,1,0,0,0,0];
% R1(10)=[7,8,9,6];
% edges(11) = [0,0,0,0,1,1,1,0,0];
% R1(11)=[1,2,3,4];
% edges(12) = [0,0,0,1,1,0,0,0,1];
% R1(12)=[1,2,3,6];
